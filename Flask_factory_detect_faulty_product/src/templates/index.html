<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Display</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.3/socket.io.min.js"></script> <!-- SocketIO 클라이언트 라이브러리 추가 -->
</head>
<body>
    <h1>Uploaded Image</h1>
    
    <script>
        // SocketIO 클라이언트 초기화
        const socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port);

        // 서버에서 new_image 이벤트를 수신했을 때 이미지 갱신
        socket.on('new_image', function(data) {
            console.log('New image path:', data.img_path);
            var imgElement = document.getElementById('uploaded-image');
            imgElement.src = data.img_path;  // 이미지 경로 업데이트
        });

        // 페이지 로드 시 img_path 값 출력 (세션 사용하지 않음)
        window.onload = function() {
            // 이미지는 서버에서 전달된 이미지 경로로 표시됨
            console.log("Waiting for image upload...");
        };
    </script>

    <!-- 초기 이미지를 표시하기 위한 img 태그, 처음에는 기본 이미지를 사용 -->
    <img id="uploaded-image" src="" alt="Uploaded Image" />

    <!-- 새로고침 시 최신 이미지로 갱신 -->
    <button onclick="window.location.reload();">Refresh</button>

</body>
</html>
